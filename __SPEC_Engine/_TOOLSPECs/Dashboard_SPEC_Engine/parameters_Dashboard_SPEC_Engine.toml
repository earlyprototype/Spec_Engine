# Dashboard SPEC Engine - Parameters
# Machine-readable configuration for web application dashboard
# Version: 1.0
# Last Updated: 2 January 2026

[metadata]
spec_version = "1.0"
created_date = "2026-01-02"
descriptor = "Dashboard_SPEC_Engine"
purpose = "Build comprehensive web dashboard for SPEC Engine framework management"

[goal]
statement = "Build a production-ready web application dashboard that enables users to interact with the SPEC Engine framework through a modern web interface, providing full functionality for managing DNA profiles, creating and editing SPECs, manually editing parameter files with validation, executing SPECs with real-time monitoring, and visualising results"
singular = true
north_star_compliant = true

[software_stack]
deployment_type = "full_stack_web_application"
architecture = "client_server"

[software_stack.frontend]
framework = "React 18+ with TypeScript"
ui_library = "Material-UI (MUI) v5"
state_management = "Redux Toolkit"
code_editor = "Monaco Editor"
real_time = "WebSocket client (Socket.io)"
build_tool = "Vite"
styling = "CSS Modules + MUI theming"

[software_stack.backend]
runtime = "Node.js 20 LTS with TypeScript"
framework = "Express.js"
websocket = "Socket.io"
file_system = "fs-extra"
validation = "Zod + TOML parser"
process_management = "PM2"

[software_stack.database]
type = "SQLite"
schema = ["DNA profiles", "SPECs metadata", "execution history", "progress logs"]
orm = "Prisma"

[software_stack.deployment]
development = "localhost:3000 (frontend), localhost:5000 (backend)"
production = "Docker containerised"
os_support = ["Windows", "macOS", "Linux"]
container = "Docker Compose"

[definition_of_complete]
primary_deliverable = "Production-ready web application with frontend and backend deployed"
core_features = [
    "DNA profile management functional",
    "SPEC management functional",
    "Parameter file editor with validation",
    "SPEC execution with real-time monitoring",
    "Progress visualisation",
    "Results display"
]
quality_standards = [
    "UI renders across desktop browsers (Chrome, Firefox, Edge)",
    "Parameter editor provides real-time validation and syntax highlighting",
    "SPEC execution integrates with existing exe_*.md files",
    "Real-time progress monitoring works without manual refresh",
    "Data persistence works correctly",
    "Error handling implemented for all user actions",
    "UI terminology matches SPEC Engine documentation"
]
verification_method = "Complete user workflow test: Create DNA → Create SPEC → Edit parameters → Execute → Monitor → View results"
build_requirements = [
    "Deployment artifact exists (Docker image or standalone package)",
    "UI fully implemented (not placeholder)",
    "Production-ready code (error handling, logging, validation)",
    "Database migrations included",
    "README with setup instructions",
    "Environment configuration template (.env.example)"
]

[components]
frontend_components = [
    "Dashboard layout with navigation",
    "DNA Profile Manager (create, edit, view)",
    "SPEC Manager (list, create, view)",
    "Parameter File Editor (Monaco with validation)",
    "Execution Controller (start, monitor)",
    "Progress Visualiser (real-time updates)",
    "Results Viewer (goal status, logs)",
    "Settings panel"
]
backend_services = [
    "REST API endpoints for CRUD operations",
    "File system service (read/write SPEC files)",
    "Validation service (TOML parsing, SPEC validation)",
    "Execution service (spawn exe_*.md processes)",
    "Progress monitoring service (watch progress.json)",
    "WebSocket service (real-time broadcasts)"
]
database_tables = [
    "dna_profiles",
    "specs",
    "executions",
    "progress_logs"
]
configuration_files = [
    ".env (environment variables)",
    "frontend config (API endpoints)",
    "backend config (file paths, port)"
]

[constraints]
respect_spec_engine_structure = true
readonly_framework_files = true
validate_toml_structure = true
use_existing_executors = true
match_engine_terminology = true
support_windows_paths = true
no_deletion_without_confirmation = true
throttle_realtime_updates = true

[constraints.file_paths]
spec_engine_root = "__SPEC_Engine/"
specs_root = "SPECs/"
framework_files_access = "read_only"

[constraints.parameter_editing]
preserve_toml_structure = true
validate_spec_engine_schema = true
backup_before_save = true

[constraints.execution]
use_existing_exe_files = true
no_reimplementation_of_executor = true
integrate_with_progress_json = true

[constraints.terminology]
use_spec_engine_terms = true
terms_to_match = ["Goal", "Task", "Step", "SPECLet", "DNA", "Critical", "Backup", "Execution Mode"]

# SPECLet and Task Structure

[[speclets]]
id = 1
name = "platform_foundation"
purpose = "Establish core infrastructure (backend API, database, file system integration)"
dependencies = []
parallel_allowed = true
critical = true

[[speclets.tasks]]
id = 1
name = "Set up backend API framework"
purpose = "Create Express.js API server with TypeScript configuration"

[[speclets.tasks.steps]]
id = 1
description = "Initialise Node.js project with TypeScript"
primary_method = "Create package.json, install Express, TypeScript, ts-node, @types/node, @types/express"
expected_output = "Backend project initialised with working TypeScript configuration"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 2
description = "Configure Express server with CORS and middleware"
primary_method = "Create src/server.ts, configure Express app with cors, express.json(), error handling"
backup_methods = ["If CORS issues during testing, use more permissive configuration for development"]
expected_output = "Express server starting on port 5000 with middleware configured"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 3
description = "Implement basic route structure"
primary_method = "Create routes/ folder with dna.routes.ts, specs.routes.ts, execution.routes.ts, files.routes.ts"
expected_output = "Route handlers stubbed out with placeholder responses"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 4
description = "Set up environment configuration"
primary_method = "Install dotenv, create .env.example with SPEC_ENGINE_PATH, SPECS_PATH, PORT, DATABASE_URL"
expected_output = "Environment variables loading correctly, .env.example documented"
critical = true
mode = "silent"

[[speclets.tasks]]
id = 2
name = "Configure database and schema"
purpose = "Set up SQLite database with Prisma ORM"

[[speclets.tasks.steps]]
id = 1
description = "Install and configure Prisma"
primary_method = "Install @prisma/client and prisma, run prisma init with SQLite provider"
expected_output = "prisma/schema.prisma file created with datasource configured"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 2
description = "Define database schema"
primary_method = "Create models in schema.prisma: DnaProfile, Spec, Execution, ProgressLog"
expected_output = "Complete schema with relationships defined"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 3
description = "Run initial migration"
primary_method = "Execute prisma migrate dev to create database and tables"
backup_methods = ["If migration fails, debug schema syntax and retry"]
expected_output = "SQLite database file created with all tables"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 4
description = "Create database service layer"
primary_method = "Create src/services/database.service.ts with PrismaClient instance and helper methods"
expected_output = "Database service exporting typed query methods"
critical = true
mode = "silent"

[[speclets.tasks]]
id = 3
name = "Implement file system service"
purpose = "Create service layer for reading/writing SPEC Engine files"

[[speclets.tasks.steps]]
id = 1
description = "Install file system dependencies"
primary_method = "Install fs-extra for enhanced file operations"
expected_output = "fs-extra available for import"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 2
description = "Create file path configuration"
primary_method = "Create src/config/paths.ts reading SPEC_ENGINE_PATH and SPECS_PATH from environment"
backup_methods = ["If environment variables not set, use default relative paths"]
expected_output = "Path configuration module exporting all required paths"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 3
description = "Implement DNA profile file operations"
primary_method = "Create src/services/dna-files.service.ts with methods: listDnaProfiles(), readDnaProfile(), writeDnaProfile()"
expected_output = "Service can read/write project_constitution.toml files"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 4
description = "Implement SPEC file operations"
primary_method = "Create src/services/spec-files.service.ts with methods: listSpecs(), readSpec(), readParameters(), writeParameters()"
expected_output = "Service can read spec_*.md and parameters_*.toml files"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 5
description = "Implement progress file monitoring"
primary_method = "Create src/services/progress-monitor.service.ts with file watcher for progress_*.json files"
expected_output = "Service can watch and emit changes to progress files"
critical = false
mode = "silent"

# SPECLet 2: Frontend Foundation

[[speclets]]
id = 2
name = "frontend_foundation"
purpose = "Establish React application architecture"
dependencies = []
parallel_allowed = true
critical = true

[[speclets.tasks]]
id = 1
name = "Set up React application with TypeScript and Vite"
purpose = "Create frontend project structure"

[[speclets.tasks.steps]]
id = 1
description = "Create Vite React TypeScript project"
primary_method = "Run npm create vite@latest frontend -- --template react-ts"
expected_output = "Frontend project created with TypeScript configuration"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 2
description = "Install core dependencies"
primary_method = "Install @mui/material, @mui/icons-material, @emotion/react, @emotion/styled, @reduxjs/toolkit, react-redux, react-router-dom, axios, socket.io-client"
expected_output = "All frontend dependencies installed"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 3
description = "Configure TypeScript and path aliases"
primary_method = "Update tsconfig.json with strict mode, path aliases (@components, @services, @store)"
expected_output = "TypeScript configuration with modern settings"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 4
description = "Set up Vite proxy for API calls"
primary_method = "Configure vite.config.ts with proxy to backend (localhost:5000)"
expected_output = "API calls proxied correctly during development"
critical = true
mode = "silent"

[[speclets.tasks]]
id = 2
name = "Implement dashboard layout and navigation"
purpose = "Create responsive dashboard shell with routing"

[[speclets.tasks.steps]]
id = 1
description = "Create layout components"
primary_method = "Create src/components/layout/ with AppLayout, Sidebar, Header, MainContent components using MUI"
expected_output = "Responsive layout with collapsible sidebar"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 2
description = "Implement navigation structure"
primary_method = "Create navigation items: Dashboard Home, DNA Profiles, SPECs, Executions, Settings"
expected_output = "Sidebar navigation with icons and labels"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 3
description = "Configure React Router"
primary_method = "Set up BrowserRouter with routes for all major sections, create placeholder pages"
expected_output = "Routing working, navigation changes views"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 4
description = "Implement MUI theme customisation"
primary_method = "Create custom theme matching SPEC Engine aesthetics (professional, modern colour scheme)"
expected_output = "Consistent theming across application"
critical = false
mode = "silent"

[[speclets.tasks]]
id = 3
name = "Configure state management with Redux Toolkit"
purpose = "Set up centralised state management"

[[speclets.tasks.steps]]
id = 1
description = "Create Redux store structure"
primary_method = "Create src/store/ with store.ts, configure Redux Toolkit store"
expected_output = "Redux store configured and provided to app"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 2
description = "Create initial slices"
primary_method = "Create slices: dnaSlice (DNA profiles state), specsSlice (SPECs state), executionSlice (execution state)"
expected_output = "Slices with initial state, reducers, and actions"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 3
description = "Set up API service layer"
primary_method = "Create src/services/api.ts with axios instance and typed API methods"
expected_output = "API service with methods for all backend endpoints"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 4
description = "Implement Redux async thunks"
primary_method = "Create async thunks for data fetching (fetchDnaProfiles, fetchSpecs, startExecution, etc.)"
expected_output = "Async operations integrated with Redux slices"
critical = true
mode = "silent"

# SPECLet 3: DNA Profile Management

[[speclets]]
id = 3
name = "dna_profile_management"
purpose = "Enable DNA profile creation and management"
dependencies = ["platform_foundation", "frontend_foundation"]
parallel_allowed = false
critical = true

[[speclets.tasks]]
id = 1
name = "Build DNA profile list view"
purpose = "Display all DNA profiles with metadata"

[[speclets.tasks.steps]]
id = 1
description = "Create backend endpoint for listing DNA profiles"
primary_method = "Implement GET /api/dna endpoint returning list from database + file system"
expected_output = "API endpoint returning DNA profiles with dna_code, project name, settings"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 2
description = "Build DnaList component"
primary_method = "Create src/pages/DnaProfiles/DnaList.tsx with MUI DataGrid or Table displaying profiles"
expected_output = "Table showing DNA profiles with search/filter capabilities"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 3
description = "Add profile actions"
primary_method = "Add action buttons: View, Edit, Create New"
expected_output = "Buttons navigate to appropriate views"
critical = true
mode = "silent"

[[speclets.tasks]]
id = 2
name = "Implement DNA creation form"
purpose = "Allow users to create new DNA profiles through form"

[[speclets.tasks.steps]]
id = 1
description = "Create DNA creation backend endpoint"
primary_method = "Implement POST /api/dna endpoint that generates DNA code and creates project_constitution.toml"
expected_output = "API creates DNA directory and configuration file"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 2
description = "Build DNA creation form"
primary_method = "Create src/pages/DnaProfiles/DnaCreate.tsx with form fields matching DNA_SPEC interview questions"
expected_output = "Form with fields for testing, risk, autonomy, custom tools, constraints"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 3
description = "Implement form validation"
primary_method = "Use React Hook Form with Zod schema validation"
backup_methods = ["If validation library causes issues, implement manual validation"]
expected_output = "Form validates inputs before submission"
critical = false
mode = "silent"

[[speclets.tasks.steps]]
id = 4
description = "Handle form submission"
primary_method = "Dispatch Redux action to create DNA profile, show success/error feedback"
expected_output = "DNA profile created, user redirected to profile list"
critical = true
mode = "silent"

[[speclets.tasks]]
id = 3
name = "Add DNA editing and viewing capabilities"
purpose = "Allow viewing and editing existing DNA profiles"

[[speclets.tasks.steps]]
id = 1
description = "Create DNA view/edit backend endpoints"
primary_method = "Implement GET /api/dna/:dnaCode and PUT /api/dna/:dnaCode endpoints"
expected_output = "API can retrieve and update DNA configuration"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 2
description = "Build DNA detail viewer"
primary_method = "Create src/pages/DnaProfiles/DnaDetail.tsx displaying all DNA settings in readable format"
expected_output = "Component shows DNA code, project name, all configuration settings"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 3
description = "Implement DNA editing"
primary_method = "Add edit mode to DnaDetail with form for updating settings"
expected_output = "User can modify DNA settings and save changes"
critical = true
mode = "silent"

# SPECLet 4: SPEC Management

[[speclets]]
id = 4
name = "spec_management"
purpose = "Enable browsing and managing SPECs"
dependencies = ["platform_foundation", "frontend_foundation"]
parallel_allowed = true
critical = true

[[speclets.tasks]]
id = 1
name = "Build SPEC list view with filtering"
purpose = "Display all SPECs across DNA profiles"

[[speclets.tasks.steps]]
id = 1
description = "Create backend endpoint for listing SPECs"
primary_method = "Implement GET /api/specs endpoint scanning file system for all spec_*.md files"
expected_output = "API returns list of SPECs with metadata (descriptor, DNA code, goal, status)"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 2
description = "Build SpecList component"
primary_method = "Create src/pages/Specs/SpecList.tsx with table/grid view of SPECs"
expected_output = "Table showing SPEC name, DNA, goal, last executed, status"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 3
description = "Implement filtering and search"
primary_method = "Add filter controls for DNA profile, status (completed/pending), search by name/goal"
expected_output = "Users can filter and search SPEC list"
critical = false
mode = "silent"

[[speclets.tasks]]
id = 2
name = "Implement SPEC creation interface"
purpose = "Provide UI for creating new SPECs (simplified version, not full Commander)"

[[speclets.tasks.steps]]
id = 1
description = "Create SPEC creation backend endpoint"
primary_method = "Implement POST /api/specs endpoint that creates spec_*.md, parameters_*.toml from template"
expected_output = "API creates SPEC files in appropriate DNA folder"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 2
description = "Build SPEC creation form"
primary_method = "Create src/pages/Specs/SpecCreate.tsx with basic form (descriptor, DNA code, goal, software stack)"
expected_output = "Form for creating simple SPEC from template"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 3
description = "Handle SPEC file generation"
primary_method = "Form submission triggers API call, backend generates files from templates"
expected_output = "New SPEC files created, user redirected to SPEC detail"
critical = true
mode = "silent"

[[speclets.tasks]]
id = 3
name = "Add SPEC detail viewer"
purpose = "Display SPEC details including goal, tasks, completion criteria"

[[speclets.tasks.steps]]
id = 1
description = "Create SPEC detail backend endpoint"
primary_method = "Implement GET /api/specs/:specId endpoint reading spec_*.md and parsing structure"
expected_output = "API returns parsed SPEC data (goal, tasks, steps, completion criteria)"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 2
description = "Build SpecDetail component"
primary_method = "Create src/pages/Specs/SpecDetail.tsx displaying SPEC information in structured format"
expected_output = "Component shows goal, tasks breakdown, definition of complete, software stack"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 3
description = "Add action buttons"
primary_method = "Add buttons: Edit Parameters, Execute SPEC, View Progress, View Results"
expected_output = "Buttons navigate to appropriate features"
critical = true
mode = "silent"

# SPECLet 5: Parameter File Editor

[[speclets]]
id = 5
name = "parameter_file_editor"
purpose = "Provide advanced TOML editor with validation"
dependencies = ["platform_foundation", "frontend_foundation"]
parallel_allowed = false
critical = true

[[speclets.tasks]]
id = 1
name = "Integrate Monaco Editor component"
purpose = "Embed VS Code editor component for file editing"

[[speclets.tasks.steps]]
id = 1
description = "Install Monaco Editor"
primary_method = "Install @monaco-editor/react package"
expected_output = "Monaco Editor dependency available"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 2
description = "Create ParameterEditor component"
primary_method = "Create src/components/ParameterEditor/ParameterEditor.tsx wrapping Monaco Editor"
expected_output = "Component renders editor with TOML syntax highlighting"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 3
description = "Configure TOML language support"
primary_method = "Register TOML language with Monaco, configure syntax highlighting rules"
backup_methods = ["If TOML support limited, use INI or similar syntax as fallback"]
expected_output = "TOML files display with proper syntax highlighting"
critical = false
mode = "silent"

[[speclets.tasks.steps]]
id = 4
description = "Implement editor preferences"
primary_method = "Add settings: theme (light/dark), font size, line numbers, minimap"
expected_output = "Editor preferences customisable by user"
critical = false
mode = "silent"

[[speclets.tasks]]
id = 2
name = "Implement TOML syntax validation"
purpose = "Validate TOML syntax and SPEC Engine schema compliance"

[[speclets.tasks.steps]]
id = 1
description = "Install TOML parser"
primary_method = "Install @iarna/toml or smol-toml for TOML parsing"
expected_output = "TOML parser available in backend"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 2
description = "Create validation backend endpoint"
primary_method = "Implement POST /api/validate/toml endpoint that parses and validates TOML structure"
expected_output = "API returns validation result with errors/warnings"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 3
description = "Implement real-time validation in editor"
primary_method = "Add onChange handler that debounces and calls validation endpoint"
expected_output = "Validation errors shown in editor with line numbers"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 4
description = "Add SPEC Engine schema validation"
primary_method = "Validate TOML contains required sections: metadata, goal, tasks, steps"
expected_output = "Schema validation catches missing required fields"
critical = false
mode = "silent"

[[speclets.tasks]]
id = 3
name = "Add save functionality with backup"
purpose = "Enable saving edited parameters with automatic backup"

[[speclets.tasks.steps]]
id = 1
description = "Create parameter save backend endpoint"
primary_method = "Implement PUT /api/specs/:specId/parameters endpoint that writes to parameters_*.toml"
expected_output = "API saves edited TOML to file"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 2
description = "Implement automatic backup before save"
primary_method = "Backend creates backup copy in .backups/ folder with timestamp before overwriting"
expected_output = "Original file backed up before each save"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 3
description = "Add save UI controls"
primary_method = "Add Save button with keyboard shortcut (Ctrl+S), show save status indicator"
expected_output = "User can save file, receives confirmation feedback"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 4
description = "Implement unsaved changes warning"
primary_method = "Track dirty state, show warning dialog if user navigates away with unsaved changes"
expected_output = "User prompted before losing unsaved edits"
critical = false
mode = "silent"

# SPECLet 6: Execution & Monitoring

[[speclets]]
id = 6
name = "execution_monitoring"
purpose = "Enable SPEC execution with real-time progress monitoring"
dependencies = ["platform_foundation", "frontend_foundation", "dna_profile_management", "spec_management", "parameter_file_editor"]
parallel_allowed = false
critical = true

[[speclets.tasks]]
id = 1
name = "Implement execution service (backend)"
purpose = "Backend service to spawn and manage SPEC execution"

[[speclets.tasks.steps]]
id = 1
description = "Install process management dependencies"
primary_method = "Install child_process utilities for spawning LLM processes"
expected_output = "Process spawning available"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 2
description = "Create execution service"
primary_method = "Create src/services/execution.service.ts with methods: startExecution(), stopExecution(), getExecutionStatus()"
expected_output = "Service can spawn exe_*.md execution and track process"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 3
description = "Implement execution endpoint"
primary_method = "Create POST /api/executions endpoint that starts SPEC execution, returns execution_id"
expected_output = "API starts execution and returns tracking ID"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 4
description = "Handle execution lifecycle"
primary_method = "Track execution state (pending, running, completed, failed), update database"
expected_output = "Execution records created and updated in database"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 5
description = "Implement execution log capture"
primary_method = "Capture stdout/stderr from execution process, store in database or file"
expected_output = "Execution logs available for viewing"
critical = false
mode = "silent"

[[speclets.tasks]]
id = 2
name = "Build progress monitoring with WebSocket"
purpose = "Real-time progress updates via WebSocket"

[[speclets.tasks.steps]]
id = 1
description = "Configure Socket.io on backend"
primary_method = "Install socket.io, set up WebSocket server on Express"
expected_output = "WebSocket server running on backend"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 2
description = "Implement progress file watcher"
primary_method = "Use fs.watch or chokidar to watch progress_*.json files, emit changes via WebSocket"
expected_output = "Progress updates broadcast when files change"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 3
description = "Create WebSocket client in frontend"
primary_method = "Use socket.io-client to connect to backend WebSocket"
expected_output = "Frontend receives real-time progress updates"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 4
description = "Implement reconnection logic"
primary_method = "Handle WebSocket disconnections, auto-reconnect with exponential backoff"
backup_methods = ["If WebSocket unreliable, fall back to polling progress endpoint"]
expected_output = "Connection resilient to network issues"
critical = false
mode = "silent"

[[speclets.tasks]]
id = 3
name = "Create execution controller UI"
purpose = "UI for starting execution and monitoring progress"

[[speclets.tasks.steps]]
id = 1
description = "Build execution control panel"
primary_method = "Create src/pages/Execution/ExecutionControl.tsx with mode selection and start button"
expected_output = "UI allows selecting execution mode (Silent/Dynamic/Collaborative) and starting execution"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 2
description = "Implement progress visualisation"
primary_method = "Create ProgressMonitor component displaying task/step breakdown with status indicators"
expected_output = "Visual representation of execution progress (tasks, steps, status)"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 3
description = "Add real-time progress updates"
primary_method = "Connect ProgressMonitor to WebSocket, update UI when progress events received"
expected_output = "Progress UI updates in real-time without manual refresh"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 4
description = "Implement execution controls"
primary_method = "Add buttons: Stop Execution, View Logs, View Full Progress (open progress.json)"
expected_output = "User can control and inspect running execution"
critical = false
mode = "silent"

# SPECLet 7: Results Visualisation

[[speclets]]
id = 7
name = "results_visualisation"
purpose = "Display execution results and history"
dependencies = ["execution_monitoring"]
parallel_allowed = false
critical = true

[[speclets.tasks]]
id = 1
name = "Build results viewer component"
purpose = "Display execution outcome and completion verification"

[[speclets.tasks.steps]]
id = 1
description = "Create results backend endpoint"
primary_method = "Implement GET /api/executions/:executionId/results reading progress_*.json and parsing completion data"
expected_output = "API returns goal achievement status, completion verification, post-execution analysis"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 2
description = "Build ResultsViewer component"
primary_method = "Create src/pages/Results/ResultsViewer.tsx displaying goal status (ACHIEVED/PARTIAL/NOT ACHIEVED)"
expected_output = "Component shows outcome with visual indicator (success/warning/error)"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 3
description = "Display completion verification"
primary_method = "Show verification checklist with status (primary deliverable, quality standards, verification method)"
expected_output = "User sees which completion criteria passed/failed"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 4
description = "Show post-execution analysis"
primary_method = "Display failure patterns, backup effectiveness, constitutional compliance score"
expected_output = "Analysis section shows insights from execution"
critical = false
mode = "silent"

[[speclets.tasks]]
id = 2
name = "Implement execution history browser"
purpose = "Browse past executions with filtering"

[[speclets.tasks.steps]]
id = 1
description = "Create execution history endpoint"
primary_method = "Implement GET /api/executions endpoint querying database for past executions"
expected_output = "API returns list of executions with metadata (spec, status, duration, timestamp)"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 2
description = "Build ExecutionHistory component"
primary_method = "Create src/pages/Results/ExecutionHistory.tsx with table of past executions"
expected_output = "Table showing execution history with filtering by SPEC, date, status"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 3
description = "Add execution comparison"
primary_method = "Allow selecting multiple executions to compare outcomes"
expected_output = "Side-by-side comparison of execution results"
critical = false
mode = "silent"

[[speclets.tasks]]
id = 3
name = "Add completion verification display"
purpose = "Detailed view of completion criteria verification"

[[speclets.tasks.steps]]
id = 1
description = "Create verification detail component"
primary_method = "Create CompletionVerification component showing each criterion with pass/fail status"
expected_output = "Component displays universal checks and build-specific verification"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 2
description = "Add drill-down to verification details"
primary_method = "Allow expanding each criterion to see details (e.g., which files verified, what tests passed)"
expected_output = "User can see granular verification information"
critical = false
mode = "silent"

# SPECLet 8: Deployment & Documentation

[[speclets]]
id = 8
name = "deployment_documentation"
purpose = "Prepare application for production deployment"
dependencies = ["platform_foundation", "frontend_foundation", "dna_profile_management", "spec_management", "parameter_file_editor", "execution_monitoring", "results_visualisation"]
parallel_allowed = false
critical = true

[[speclets.tasks]]
id = 1
name = "Create Docker configuration"
purpose = "Containerise application for easy deployment"

[[speclets.tasks.steps]]
id = 1
description = "Create backend Dockerfile"
primary_method = "Write Dockerfile for Node.js backend with multi-stage build (build + production)"
expected_output = "Backend Dockerfile building working image"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 2
description = "Create frontend Dockerfile"
primary_method = "Write Dockerfile for frontend with Nginx serving static build"
expected_output = "Frontend Dockerfile building working image"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 3
description = "Create Docker Compose configuration"
primary_method = "Write docker-compose.yml orchestrating backend, frontend, database"
expected_output = "docker-compose up starts complete application stack"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 4
description = "Add volume configuration for SPEC Engine files"
primary_method = "Configure volumes to mount __SPEC_Engine/ and SPECs/ directories"
expected_output = "Container accesses host file system for SPEC files"
critical = true
mode = "silent"

[[speclets.tasks]]
id = 2
name = "Write comprehensive README and setup guide"
purpose = "Document installation, configuration, and usage"

[[speclets.tasks.steps]]
id = 1
description = "Create main README.md"
primary_method = "Write README with sections: Overview, Features, Requirements, Installation, Configuration, Usage"
expected_output = "Comprehensive README documenting entire application"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 2
description = "Document environment configuration"
primary_method = "Create .env.example with all required variables documented"
expected_output = "Users know how to configure application"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 3
description = "Write deployment guide"
primary_method = "Create DEPLOYMENT.md with instructions for Docker, standalone, and development setup"
expected_output = "Clear deployment instructions for different scenarios"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 4
description = "Create API documentation"
primary_method = "Document all API endpoints with request/response examples"
expected_output = "API.md file with complete endpoint documentation"
critical = false
mode = "silent"

[[speclets.tasks]]
id = 3
name = "Implement production build and optimisation"
purpose = "Optimise application for production deployment"

[[speclets.tasks.steps]]
id = 1
description = "Configure frontend production build"
primary_method = "Optimise Vite build configuration (minification, tree-shaking, code splitting)"
expected_output = "Frontend builds to optimised static assets"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 2
description = "Implement backend production settings"
primary_method = "Add production mode configuration (logging, error handling, security headers)"
expected_output = "Backend runs efficiently in production mode"
critical = true
mode = "silent"

[[speclets.tasks.steps]]
id = 3
description = "Add health check endpoints"
primary_method = "Implement /health and /ready endpoints for monitoring"
expected_output = "Monitoring systems can check application health"
critical = false
mode = "silent"

[[speclets.tasks.steps]]
id = 4
description = "Implement logging"
primary_method = "Add structured logging with Winston or Pino"
expected_output = "Production logs are structured and queryable"
critical = false
mode = "silent"

# Execution Configuration

[execution]
default_mode = "dynamic"
allow_mode_switching = true
supported_modes = ["silent", "dynamic", "collaborative"]

[execution.dynamic_escalation]
enabled = true
trigger_consecutive_failures = 3
trigger_backup_exhaustion = true
trigger_critical_step_failure = true

[execution.logging]
log_level = "info"
log_all_steps = true
log_decisions = true
log_mode_switches = true
log_constitutional_compliance = true

[execution.progress_tracking]
create_progress_json = true
update_frequency = "per_step"
track_timestamps = true
track_methods_used = true
track_retry_counts = true

# Constitutional Compliance

[constitutional_compliance]
article_i_north_star = true
article_ii_hierarchy = true
article_iii_bridging = true
article_vi_critical_balance_min = 0.40
article_vi_critical_balance_max = 0.60
article_vii_genuine_backups = true
article_ix_execution_modes = true
article_xiv_build_completeness = true

[constitutional_compliance.verification]
pre_flight = true
runtime = true
post_execution = true

# Post-Execution Analysis

[post_execution_analysis]
enabled = true

[post_execution_analysis.metrics]
overall_failure_rate = true
backup_effectiveness = true
mode_escalation_count = true
constitutional_compliance_score = true
goal_achievement_status = true

[post_execution_analysis.recommendations]
critical_balance_assessment = true
backup_quality_assessment = true
execution_mode_appropriateness = true
improvements_suggested = true
